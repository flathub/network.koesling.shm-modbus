id: network.koesling.shm-modbus
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
command: shm-modbus
finish-args:
  - --device=shm
  - --share=network
modules:
  - name: Modbus_TCP_client_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.2.3
        commit: 5a1d7f6a85fb00b109c04f22a9bdf2e3b4da7ba6
        url: https://github.com/NikolasK-source/modbus_tcp_client_shm.git
        disable-shallow-clone: true

  - name: Modbus_RTU_client_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v0.2.3
        commit: aeca250f9849fc65444561ad755755b406beac78 
        url: https://github.com/NikolasK-source/modbus_rtu_client_shm.git
        disable-shallow-clone: true

  - name: write_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v0.1.3
        commit: bc58b820a79fd00a699835acbfb23f8870c7a528 
        url: https://github.com/NikolasK-source/write_shm.git

  - name: SHM_random
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.0.5
        commit: 95c72b58cc2fc73447c7abae07622af1219b7f08 
        url: https://github.com/NikolasK-source/shared_mem_random.git

  - name: dump_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.0.2
        commit: b39922ac9dbb3b37a73ffc0eed3c56582d0c50e9 
        url: https://github.com/NikolasK-source/dump_shm.git

  - name: stdin-to-modbus-shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.1.1
        commit: d107673fd9afe9d364490db73508ec563f9a4e9c 
        url: https://github.com/NikolasK-source/stdin_to_modbus_shm.git

  - name: shm-stack-machine
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF
      - -DBUILD_DOC=OFF
    sources:
      - type: git
        tag: v0.0.1
        commit: 2202c55f478e7fa7274271994549c2e370465e4a 
        url: https://github.com/NikolasK-source/shm_stack_machine.git

  - name: modbus-shm-to-stdout
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF
      - -DBUILD_DOC=OFF
    sources:
      - type: git
        tag: v0.0.1
        commit: e14b12e69eab92bb8a73d5fdf725168082b4f904 
        url: https://github.com/NikolasK-source/modbus_shm_to_stdout.git

  - name: launch_scripts_and_metadata
    buildsystem: simple
    build-commands:
      - install -D -m 755 shm-modbus ${FLATPAK_DEST}/bin/shm-modbus
      - install -D -m 644 guided-commands.sh ${FLATPAK_DEST}/bin/guided-commands.sh
      - install -D -m 644 manual-commands.sh ${FLATPAK_DEST}/bin/manual-commands.sh

      - install -D -m 644 network.koesling.shm-modbus.metainfo.xml "${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml"
      - install -D -m 644 -t "${FLATPAK_DEST}/share/icons/hicolor/scalable/apps" ${FLATPAK_ID}.svg
      - install -D -m 644 ${FLATPAK_ID}_256.png "${FLATPAK_DEST}/share/icons/hicolor/256x256/apps/${FLATPAK_ID}.png"
      - install -D -m 644 -t ${FLATPAK_DEST}/share/applications/ ${FLATPAK_ID}.desktop

    sources:
      - type: git
        tag: v1.1.0-beta1
        commit: 57e6b897204a69cea66df96d060b2dd5a7cbb8a3 
        url: https://github.com/NikolasK-source/SHM_Modbus.git
